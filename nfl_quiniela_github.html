<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiniela NFL Playoffs</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Iconos SVG simples
        const Trophy = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"></path>
                <path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"></path>
                <path d="M4 22h16"></path>
                <path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"></path>
                <path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"></path>
                <path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"></path>
            </svg>
        );

        const Users = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
            </svg>
        );

        const Plus = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
        );

        const Trash = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M3 6h18"></path>
                <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path>
                <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path>
            </svg>
        );

        const Award = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <circle cx="12" cy="8" r="7"></circle>
                <polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"></polyline>
            </svg>
        );

        const Check = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
        );

        const Edit = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
            </svg>
        );

        const NFLPlayoffBracket = () => {
            const [players, setPlayers] = useState([]);
            const [newPlayerName, setNewPlayerName] = useState('');
            const [view, setView] = useState('leaderboard');
            const [games, setGames] = useState({});
            const [predictions, setPredictions] = useState({});

            const rounds = [
                { id: 'wildcard', name: 'Wild Card', games: 6 },
                { id: 'divisional', name: 'Divisional', games: 4 },
                { id: 'conference', name: 'Conference', games: 2 },
                { id: 'superbowl', name: 'Super Bowl', games: 1 }
            ];

            useEffect(() => {
                loadData();
            }, []);

            const loadData = () => {
                try {
                    const savedPlayers = localStorage.getItem('nfl-players');
                    const savedGames = localStorage.getItem('nfl-games');
                    const savedPredictions = localStorage.getItem('nfl-predictions');

                    if (savedPlayers) setPlayers(JSON.parse(savedPlayers));
                    if (savedGames) setGames(JSON.parse(savedGames));
                    if (savedPredictions) setPredictions(JSON.parse(savedPredictions));
                } catch (error) {
                    console.log('Iniciando datos nuevos');
                }
            };

            const saveData = (newPlayers, newGames, newPredictions) => {
                try {
                    localStorage.setItem('nfl-players', JSON.stringify(newPlayers));
                    localStorage.setItem('nfl-games', JSON.stringify(newGames));
                    localStorage.setItem('nfl-predictions', JSON.stringify(newPredictions));
                } catch (error) {
                    console.error('Error guardando datos:', error);
                }
            };

            const addPlayer = () => {
                if (newPlayerName.trim()) {
                    const newPlayers = [...players, { id: Date.now(), name: newPlayerName.trim() }];
                    setPlayers(newPlayers);
                    saveData(newPlayers, games, predictions);
                    setNewPlayerName('');
                }
            };

            const removePlayer = (playerId) => {
                const newPlayers = players.filter(p => p.id !== playerId);
                setPlayers(newPlayers);

                const newPredictions = { ...predictions };
                Object.keys(newPredictions).forEach(key => {
                    if (newPredictions[key]?.[playerId]) {
                        delete newPredictions[key][playerId];
                    }
                });
                setPredictions(newPredictions);
                saveData(newPlayers, games, newPredictions);
            };

            const updateGame = (roundId, gameIndex, field, value) => {
                const key = `${roundId}-${gameIndex}`;
                const newGames = { ...games };

                if (!newGames[key]) {
                    newGames[key] = { team1: '', team2: '', winner: null };
                }

                newGames[key][field] = value;
                setGames(newGames);
                saveData(players, newGames, predictions);
            };

            const setPrediction = (roundId, gameIndex, playerId, teamChoice) => {
                const key = `${roundId}-${gameIndex}`;
                const newPredictions = { ...predictions };

                if (!newPredictions[key]) {
                    newPredictions[key] = {};
                }

                newPredictions[key][playerId] = teamChoice;
                setPredictions(newPredictions);
                saveData(players, games, newPredictions);
            };

            const calculateScore = (playerId) => {
                let score = 0;
                Object.keys(games).forEach(key => {
                    const game = games[key];
                    const prediction = predictions[key]?.[playerId];

                    if (game.winner !== null && prediction === game.winner) {
                        score++;
                    }
                });
                return score;
            };

            const getLeaderboard = () => {
                return players
                    .map(player => ({
                        ...player,
                        score: calculateScore(player.id)
                    }))
                    .sort((a, b) => b.score - a.score);
            };

            const resetAll = () => {
                if (window.confirm('¿Estás seguro de que quieres resetear toda la quiniela?')) {
                    setPlayers([]);
                    setGames({});
                    setPredictions({});
                    localStorage.clear();
                }
            };

            const leaderboard = getLeaderboard();

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-900 via-purple-900 to-indigo-900 p-4">
                    <div className="max-w-7xl mx-auto">
                        {/* Header */}
                        <div className="text-center mb-8">
                            <div className="flex items-center justify-center gap-3 mb-2">
                                <div className="text-yellow-400"><Trophy /></div>
                                <h1 className="text-4xl md:text-5xl font-bold text-white">
                                    Quiniela NFL Playoffs
                                </h1>
                            </div>
                            <p className="text-blue-200 text-lg">
                                Configura partidos, haz predicciones y compite
                            </p>
                        </div>

                        {/* Navigation */}
                        <div className="flex gap-2 mb-6 overflow-x-auto">
                            <button
                                onClick={() => setView('leaderboard')}
                                className={`px-6 py-3 rounded-lg font-semibold transition whitespace-nowrap flex items-center gap-2 ${
                                    view === 'leaderboard'
                                        ? 'bg-blue-500 text-white'
                                        : 'bg-white/20 text-white hover:bg-white/30'
                                }`}
                            >
                                <Award />
                                Tabla de Posiciones
                            </button>
                            <button
                                onClick={() => setView('results')}
                                className={`px-6 py-3 rounded-lg font-semibold transition whitespace-nowrap flex items-center gap-2 ${
                                    view === 'results'
                                        ? 'bg-blue-500 text-white'
                                        : 'bg-white/20 text-white hover:bg-white/30'
                                }`}
                            >
                                <Check />
                                Resultados Reales
                            </button>
                            <button
                                onClick={() => setView('predictions')}
                                className={`px-6 py-3 rounded-lg font-semibold transition whitespace-nowrap flex items-center gap-2 ${
                                    view === 'predictions'
                                        ? 'bg-blue-500 text-white'
                                        : 'bg-white/20 text-white hover:bg-white/30'
                                }`}
                            >
                                <Edit />
                                Predicciones
                            </button>
                        </div>

                        {/* Añadir jugadores */}
                        <div className="bg-white/10 backdrop-blur-lg rounded-xl p-6 mb-6 border border-white/20">
                            <h2 className="text-2xl font-bold text-white mb-4 flex items-center gap-2">
                                <Users />
                                Jugadores
                            </h2>

                            <div className="flex gap-2 mb-4">
                                <input
                                    type="text"
                                    value={newPlayerName}
                                    onChange={(e) => setNewPlayerName(e.target.value)}
                                    onKeyPress={(e) => e.key === 'Enter' && addPlayer()}
                                    placeholder="Nombre del jugador..."
                                    className="flex-1 px-4 py-2 rounded-lg bg-white/20 text-white placeholder-white/50 border border-white/30 focus:outline-none focus:ring-2 focus:ring-blue-400"
                                />
                                <button
                                    onClick={addPlayer}
                                    className="px-6 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg font-semibold flex items-center gap-2 transition"
                                >
                                    <Plus />
                                    Añadir
                                </button>
                            </div>

                            <div className="grid grid-cols-2 md:grid-cols-4 gap-2">
                                {players.map(player => (
                                    <div
                                        key={player.id}
                                        className="p-3 rounded-lg bg-white/20 text-white flex items-center justify-between"
                                    >
                                        <span className="font-semibold">{player.name}</span>
                                        <button
                                            onClick={() => removePlayer(player.id)}
                                            className="p-1 hover:bg-red-500 rounded"
                                        >
                                            <Trash />
                                        </button>
                                    </div>
                                ))}
                            </div>

                            {players.length === 0 && (
                                <p className="text-white/60 text-center py-4">
                                    Añade jugadores para comenzar
                                </p>
                            )}
                        </div>

                        {/* Vista de Tabla de Posiciones */}
                        {view === 'leaderboard' && players.length > 0 && (
                            <div className="bg-white/10 backdrop-blur-lg rounded-xl p-6 mb-6 border border-white/20">
                                <h2 className="text-2xl font-bold text-white mb-4">
                                    Tabla de Posiciones
                                </h2>

                                <div className="space-y-2">
                                    {leaderboard.map((player, index) => (
                                        <div
                                            key={player.id}
                                            className={`flex items-center justify-between p-4 rounded-lg ${
                                                index === 0
                                                    ? 'bg-yellow-500/30 border-2 border-yellow-400'
                                                    : 'bg-white/10'
                                            }`}
                                        >
                                            <div className="flex items-center gap-3">
                                                <span className="text-2xl font-bold text-white w-8">
                                                    {index + 1}°
                                                </span>
                                                <span className="text-xl font-semibold text-white">
                                                    {player.name}
                                                </span>
                                            </div>
                                            <div className="text-right">
                                                <div className="text-3xl font-bold text-white">
                                                    {player.score}
                                                </div>
                                                <div className="text-sm text-white/70">
                                                    {player.score === 1 ? 'acierto' : 'aciertos'}
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {/* Vista de Resultados Reales */}
                        {view === 'results' && (
                            <div className="bg-white/10 backdrop-blur-lg rounded-xl p-6 mb-6 border border-white/20">
                                <h2 className="text-2xl font-bold text-white mb-4">
                                    Registrar Resultados Reales
                                </h2>

                                {rounds.map(round => (
                                    <div key={round.id} className="mb-6">
                                        <h3 className="text-xl font-bold text-white mb-3 border-b border-white/30 pb-2">
                                            {round.name}
                                        </h3>

                                        <div className="space-y-4">
                                            {Array.from({ length: round.games }, (_, i) => {
                                                const key = `${round.id}-${i}`;
                                                const game = games[key] || { team1: '', team2: '', winner: null };

                                                return (
                                                    <div key={i} className="bg-white/10 rounded-lg p-4">
                                                        <div className="text-sm text-white/70 mb-2">Juego {i + 1}</div>

                                                        <div className="grid md:grid-cols-3 gap-3">
                                                            <input
                                                                type="text"
                                                                value={game.team1}
                                                                onChange={(e) => updateGame(round.id, i, 'team1', e.target.value)}
                                                                placeholder="Equipo 1"
                                                                className="px-3 py-2 rounded bg-white/20 text-white placeholder-white/50 border border-white/30 focus:outline-none focus:ring-2 focus:ring-blue-400"
                                                            />

                                                            <input
                                                                type="text"
                                                                value={game.team2}
                                                                onChange={(e) => updateGame(round.id, i, 'team2', e.target.value)}
                                                                placeholder="Equipo 2"
                                                                className="px-3 py-2 rounded bg-white/20 text-white placeholder-white/50 border border-white/30 focus:outline-none focus:ring-2 focus:ring-blue-400"
                                                            />

                                                            <div className="flex gap-2">
                                                                <button
                                                                    onClick={() => updateGame(round.id, i, 'winner', 1)}
                                                                    disabled={!game.team1}
                                                                    className={`flex-1 px-3 py-2 rounded font-semibold transition ${
                                                                        game.winner === 1
                                                                            ? 'bg-green-500 text-white'
                                                                            : 'bg-white/20 text-white hover:bg-white/30'
                                                                    } disabled:opacity-50 disabled:cursor-not-allowed`}
                                                                >
                                                                    Ganó 1
                                                                </button>
                                                                <button
                                                                    onClick={() => updateGame(round.id, i, 'winner', 2)}
                                                                    disabled={!game.team2}
                                                                    className={`flex-1 px-3 py-2 rounded font-semibold transition ${
                                                                        game.winner === 2
                                                                            ? 'bg-green-500 text-white'
                                                                            : 'bg-white/20 text-white hover:bg-white/30'
                                                                    } disabled:opacity-50 disabled:cursor-not-allowed`}
                                                                >
                                                                    Ganó 2
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                );
                                            })}
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )}

                        {/* Vista de Predicciones */}
                        {view === 'predictions' && (
                            <div className="bg-white/10 backdrop-blur-lg rounded-xl p-6 mb-6 border border-white/20">
                                <h2 className="text-2xl font-bold text-white mb-4">
                                    Hacer Predicciones
                                </h2>

                                {players.length === 0 && (
                                    <p className="text-white/60 text-center py-8">
                                        Añade jugadores primero
                                    </p>
                                )}

                                {players.map(player => (
                                    <div key={player.id} className="mb-8">
                                        <h3 className="text-xl font-bold text-white mb-4 bg-blue-500/30 p-3 rounded-lg">
                                            Predicciones de {player.name}
                                        </h3>

                                        {rounds.map(round => (
                                            <div key={round.id} className="mb-6">
                                                <h4 className="text-lg font-semibold text-white mb-3 border-b border-white/20 pb-2">
                                                    {round.name}
                                                </h4>

                                                <div className="space-y-3">
                                                    {Array.from({ length: round.games }, (_, i) => {
                                                        const key = `${round.id}-${i}`;
                                                        const game = games[key] || { team1: '', team2: '' };
                                                        const playerPrediction = predictions[key]?.[player.id];

                                                        return (
                                                            <div key={i} className="bg-white/10 rounded-lg p-3">
                                                                <div className="text-sm text-white/70 mb-2">Juego {i + 1}</div>
                                                                <div className="flex gap-2">
                                                                    <button
                                                                        onClick={() => setPrediction(round.id, i, player.id, 1)}
                                                                        disabled={!game.team1}
                                                                        className={`flex-1 px-4 py-2 rounded font-semibold transition ${
                                                                            playerPrediction === 1
                                                                                ? 'bg-blue-500 text-white'
                                                                                : 'bg-white/20 text-white hover:bg-white/30'
                                                                        } disabled:opacity-50 disabled:cursor-not-allowed`}
                                                                    >
                                                                        {game.team1 || 'Equipo 1'}
                                                                    </button>
                                                                    <button
                                                                        onClick={() => setPrediction(round.id, i, player.id, 2)}
                                                                        disabled={!game.team2}
                                                                        className={`flex-1 px-4 py-2 rounded font-semibold transition ${
                                                                            playerPrediction === 2
                                                                                ? 'bg-blue-500 text-white'
                                                                                : 'bg-white/20 text-white hover:bg-white/30'
                                                                        } disabled:opacity-50 disabled:cursor-not-allowed`}
                                                                    >
                                                                        {game.team2 || 'Equipo 2'}
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        );
                                                    })}
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                ))}
                            </div>
                        )}

                        {/* Botón de reset */}
                        <div className="text-center">
                            <button
                                onClick={resetAll}
                                className="px-6 py-3 bg-red-500 hover:bg-red-600 text-white rounded-lg font-semibold transition"
                            >
                                Resetear Todo
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<NFLPlayoffBracket />, document.getElementById('root'));
    </script>
</body>
</html>